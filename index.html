<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Book Animator</title>

<!-- JSZip for client-side export -->
<script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

<style>
  :root{
    --bg:#0b0b0b; --text:#f0f0f0; --muted:#bdbdbd;
    --accent:#d13131; --accent-ghost:#311212; --card:#111; --border:#2a2a2a;
  }
  *{ box-sizing:border-box }
  body{ margin:0; background:var(--bg); color:var(--text); font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif; }

  /* Top title area */
  header{ padding:70px 16px 12px; text-align:center; }
  h1{ margin:0; font-size:42px; letter-spacing:.5px; }

  /* Stat chips */
  .chips{ display:flex; gap:.6rem; justify-content:center; margin:.75rem 0 1.25rem; }
  .chip{ color:var(--muted); border:1px solid var(--border); border-radius:999px; padding:.35rem .7rem; background:#161616; }

  /* Main editor */
  main{ width:min(980px, 92vw); margin:0 auto 90px; }
  label{ font-weight:700; display:block; margin:.25rem 0 .4rem; }
  textarea{
    width:100%; min-height:360px; background:#121212; color:#ddd; border:1px solid var(--border);
    border-radius:12px; padding:1rem; resize:vertical;
  }
  .btnbar{ display:flex; gap:.8rem; margin:16px 0 8px; flex-wrap:wrap; }
  .btn{
    background:var(--accent); color:white; border:none; border-radius:12px; padding:.7rem 1rem; font-weight:800; cursor:pointer;
    box-shadow:0 6px 16px rgba(0,0,0,.35);
  }
  .btn.ghost{ background:transparent; border:1px solid var(--accent); color:var(--text); }
  .btn:disabled{ opacity:.5; cursor:not-allowed }

  /* Bottom bar */
  .bottombar{
    position:fixed; left:0; right:0; bottom:0; background:#0f0f0f; border-top:1px solid var(--border);
    display:flex; align-items:center; gap:12px; padding:12px 14px; z-index:20;
  }
  .progressWrap{ flex:1; display:flex; align-items:center; gap:10px; }
  .progress{ height:10px; width:100%; background:#1a1a1a; border:1px solid var(--border); border-radius:999px; overflow:hidden; }
  .bar{ height:100%; width:0%; background:#fff; transition:width .25s ease; } /* white progress as requested */
  .pct{ width:52px; text-align:right; color:var(--muted); }

  /* Hamburgers */
  .hambox{
    position:fixed; top:14px; width:44px; height:44px; border-radius:12px;
    display:grid; place-items:center; background:#161616; border:1px solid var(--border);
    box-shadow:0 6px 18px rgba(0,0,0,.35); z-index:10000; cursor:pointer;
  }
  #btnLeft{ left:14px; }
  #btnRight{ right:14px; }
  .ham{ font-size:20px; line-height:1; color:var(--text); }

  /* Dropdown menus */
  .menu-panel{
    position:fixed; top:70px; left:14px; width:min(360px, 92vw);
    background:var(--card); border:1px solid var(--border); border-radius:16px;
    box-shadow:0 18px 50px rgba(0,0,0,.5); padding:.75rem; display:none; z-index:10001;
  }
  .menu-panel.right{ left:auto; right:14px; }
  .menu-title{ font-weight:800; font-size:1.1rem; margin:.4rem .5rem .6rem; }
  .menu-sec{ padding:.35rem .5rem .25rem; color:var(--muted); font-size:.85rem; }
  .item{
    border-radius:10px; padding:.7rem .8rem; margin:.25rem 0; cursor:pointer;
    border:1px solid var(--border); background:#151515;
  }
  .item:hover{ border-color:#3a3a3a; background:#1b1b1b; }
  .danger{ border-color:#5a1b1b; background:#161111; color:#ffb7b7; }

  /* Overlay + Modal panels */
  .overlay{ position:fixed; inset:0; background:rgba(0,0,0,.55); display:none; z-index:10002; }
  .panel{
    position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
    width:min(880px, 95vw); max-height:86vh; overflow:auto; background:var(--card);
    border:1px solid var(--border); border-radius:16px; padding:1rem; display:none; z-index:10003;
  }
  .panel h2{ margin:.25rem 0 1rem; }
  .row{ display:flex; gap:.75rem; align-items:center; margin:.5rem 0; }
  .row > label{ width:170px; color:var(--muted); }
  select, input[type="text"], input[type="file"], textarea.modalText{
    width:100%; background:#121212; border:1px solid var(--border);
    color:var(--text); border-radius:10px; padding:.6rem .7rem;
  }
  .list{ border:1px solid var(--border); border-radius:12px; background:#131313; }
  .listRow{ display:flex; align-items:center; justify-content:space-between; padding:.8rem .9rem; border-top:1px solid var(--border); }
  .listRow:first-child{ border-top:none; }
  .chipsRow{ display:flex; gap:.5rem; flex-wrap:wrap; }
  .chip{ padding:.35rem .6rem; border:1px solid var(--border); border-radius:999px; background:#171717; }
  .thumbs{ display:grid; grid-template-columns:repeat(auto-fill, minmax(90px,1fr)); gap:.6rem; }
  .thumbs img{ width:100%; border-radius:8px; border:1px solid var(--border); background:#0e0e0e; }
</style>
</head>
<body>

<!-- Left & Right hamburgers -->
<button id="btnLeft" class="hambox" aria-label="Open left menu" aria-expanded="false"><span class="ham">≡</span></button>
<button id="btnRight" class="hambox" aria-label="Open right menu" aria-expanded="false"><span class="ham">≡</span></button>

<!-- Left dropdown -->
<div id="leftMenu" class="menu-panel" role="menu" aria-hidden="true">
  <div class="menu-title">Menu</div>
  <div class="menu-sec">Library</div>
  <div class="item" data-open="characters">Characters</div>
  <div class="item" data-open="voices">Voices</div>
  <div class="menu-sec">Configuration</div>
  <div class="item" data-open="settings">Settings</div>
  <div class="item" data-open="secrets">Secrets (API Keys)</div>
  <div class="menu-sec">Help</div>
  <div class="item" data-open="help">Tutorial / About</div>
</div>

<!-- Right dropdown -->
<div id="rightMenu" class="menu-panel right" role="menu" aria-hidden="true">
  <div class="menu-title">Project</div>
  <div class="item" id="actNew">New Project</div>
  <div class="item" id="actOpen">Open Project…</div>
  <div class="item" id="actSave">Save Project</div>
  <div class="item" id="actUpload">Upload Files…</div>
  <div class="item" id="actExport">Export Finished (ZIP)</div>
  <div class="item danger" id="actExit">Exit</div>
</div>

<!-- Overlay + Panels -->
<div id="overlay" class="overlay" aria-hidden="true"></div>

<!-- Characters Panel -->
<div id="panelCharacters" class="panel" role="dialog" aria-modal="true" aria-labelledby="hdrChars">
  <h2 id="hdrChars">Characters</h2>
  <div class="list" id="charList"></div>
  <div class="row" style="justify-content:flex-end;margin-top:1rem;">
    <button class="btn" id="addChar">Add Character</button>
    <button class="btn ghost" data-close>Close</button>
  </div>
</div>

<!-- Voices Panel -->
<div id="panelVoices" class="panel" role="dialog" aria-modal="true" aria-labelledby="hdrVoices">
  <h2 id="hdrVoices">Voices</h2>
  <p class="row" style="margin-top:.2rem;">Assign OpenAI TTS voices to each character (saved locally).</p>
  <div id="voiceMap"></div>
  <div class="row" style="justify-content:flex-end;margin-top:1rem;">
    <button id="saveVoices" class="btn">Save Voices</button>
  </div>
</div>

<!-- Settings Panel -->
<div id="panelSettings" class="panel" role="dialog" aria-modal="true" aria-labelledby="hdrSettings">
  <h2 id="hdrSettings">Settings</h2>
  <div class="row"><label>Animation Type</label><select id="setAnimType"></select></div>
  <div class="row"><label>Art Style</label><select id="setArtStyle"></select></div>
  <div class="row"><label>Target Audience</label>
    <select id="setAudience">
      <option>All ages</option><option>Kids (3–7)</option><option>Middle grade (8–12)</option>
      <option>YA (13–17)</option><option>Adult</option>
    </select>
  </div>
  <div class="row"><label>Aspect / FPS</label>
    <select id="setAspect"><option>16:9</option><option>9:16</option><option>1:1</option></select>
    <select id="setFps"><option>12</option><option>24</option><option>30</option></select>
  </div>
  <div class="row" style="justify-content:flex-end;margin-top:1rem;">
    <button id="saveSettings" class="btn">Save Settings</button>
  </div>
</div>

<!-- Secrets Panel -->
<div id="panelSecrets" class="panel" role="dialog" aria-modal="true" aria-labelledby="hdrSecrets">
  <h2 id="hdrSecrets">Secrets (API Keys)</h2>
  <div class="row"><label>OpenAI API Key</label><input id="keyOpenAI" type="text" placeholder="sk-..." /></div>
  <div class="row"><label>Freesound API Key</label><input id="keySfx" type="text" placeholder="..." /></div>
  <div class="row"><label>Other Provider</label><input id="keyOther" type="text" placeholder="name:key" /></div>
  <div class="row" style="justify-content:flex-end;margin-top:1rem;">
    <button id="saveSecrets" class="btn">Save Keys</button>
  </div>
</div>

<!-- Help Panel -->
<div id="panelHelp" class="panel" role="dialog" aria-modal="true" aria-labelledby="hdrHelp">
  <h2 id="hdrHelp">Tutorial / About</h2>
  <ol style="margin:.5rem 1.2rem;">
    <li>Paste your story text.</li>
    <li>Open <b>Settings</b> to pick animation & art style.</li>
    <li>Open <b>Characters</b> to edit/add characters and attach images/notes.</li>
    <li>Open <b>Voices</b> to assign OpenAI voice names.</li>
    <li>Click <b>Start Animation</b>. Thumbnails will appear as scenes process.</li>
  </ol>
  <div class="row" style="justify-content:flex-end;margin-top:1rem;">
    <button class="btn ghost" data-close>Close</button>
  </div>
</div>

<!-- Hidden file picker (Open/Upload) -->
<input id="filePicker" type="file" accept=".txt,.md,.doc,.docx,.pdf,.png,.jpg,.jpeg,.webp" multiple hidden />

<header>
  <h1>Book Animator</h1>
  <div class="chips">
    <div class="chip" id="modeChip">Mode: Simple</div>
    <div class="chip" id="sceneChip">Scenes: <span id="sceneCount">0</span></div>
  </div>
</header>

<main>
  <label for="bookText">Paste your book text:</label>
  <textarea id="bookText" placeholder="Paste text here…"></textarea>

  <div class="btnbar">
    <button id="btnStart" class="btn">Start Animation</button>
    <button id="btnPreview" class="btn ghost">Preview Scenes</button>
  </div>

  <!-- Thumbnails appear here as the mock “animation” runs -->
  <div id="thumbs" class="thumbs" aria-live="polite" style="margin-top:12px;"></div>
</main>

<!-- Bottom toolbar -->
<div class="bottombar">
  <button id="btnSave" class="btn ghost">Save</button>
  <button id="btnExportZip" class="btn">Export Finished (ZIP)</button>
  <div class="progressWrap">
    <div class="progress"><div id="bar" class="bar"></div></div>
    <div id="pct" class="pct">0%</div>
  </div>
</div>

<script>
  // ---------- Helpers ----------
  const $ = s => document.querySelector(s);
  const leftBtn  = $('#btnLeft'),  rightBtn = $('#btnRight');
  const leftMenu = $('#leftMenu'), rightMenu = $('#rightMenu');
  const overlay  = $('#overlay');
  const panels = {
    characters: $('#panelCharacters'),
    voices:     $('#panelVoices'),
    settings:   $('#panelSettings'),
    secrets:    $('#panelSecrets'),
    help:       $('#panelHelp'),
  };
  const app = window.appState = window.appState || {};

  // ---------- Menus show/hide ----------
  function showMenu(box, btn){
    hideAll();
    box.style.display='block';
    btn.setAttribute('aria-expanded','true');
    box.setAttribute('aria-hidden','false');
  }
  function hideAll(){
    [leftMenu,rightMenu].forEach(m=>{ m.style.display='none'; m.setAttribute('aria-hidden','true'); });
    [leftBtn,rightBtn].forEach(b=>b.setAttribute('aria-expanded','false'));
    closePanels();
  }
  leftBtn.addEventListener('click', e=>{ e.stopPropagation(); (leftMenu.style.display==='block')?hideAll():showMenu(leftMenu,leftBtn); });
  rightBtn.addEventListener('click',e=>{ e.stopPropagation(); (rightMenu.style.display==='block')?hideAll():showMenu(rightMenu,rightBtn); });
  document.addEventListener('click', e=>{
    const inMenus = leftMenu.contains(e.target) || rightMenu.contains(e.target);
    const inBtns  = e.target===leftBtn || e.target===rightBtn || leftBtn.contains(e.target) || rightBtn.contains(e.target);
    if(!inMenus && !inBtns) hideAll();
  });

  // ---------- Panels ----------
  function openPanel(name){
    overlay.style.display='block'; overlay.setAttribute('aria-hidden','false');
    panels[name].style.display='block';
    hideAll(); // close dropdowns
  }
  function closePanels(){
    overlay.style.display='none'; overlay.setAttribute('aria-hidden','true');
    Object.values(panels).forEach(p=>p.style.display='none');
  }
  overlay.addEventListener('click', closePanels);
  document.querySelectorAll('[data-close]').forEach(b=>b.addEventListener('click', closePanels));

  leftMenu.addEventListener('click', (e)=>{
    const t = e.target.closest('.item'); if(!t) return;
    const which = t.getAttribute('data-open'); if(which) openPanel(which);
  });

  // ---------- Right menu actions ----------
  $('#actNew').onclick   = ()=>{ if(confirm('Start a new project? Unsaved changes will be lost.')) { localStorage.clear(); location.reload(); } };
  $('#actOpen').onclick  = ()=>$('#filePicker').click();
  $('#actSave').onclick  = ()=>$('#btnSave').click();
  $('#actUpload').onclick= ()=>$('#filePicker').click();
  $('#actExport').onclick= ()=>$('#btnExportZip').click();
  $('#actExit').onclick  = ()=>window.scrollTo({top:0,behavior:'smooth'});

  // ---------- Settings options ----------
  const animTypes = [
    'Comic','Cartoon','Anime','Dark Fantasy','Flip-Book','3D Toon','Watercolor',
    'Papercut / Stop-Motion','Pixel Art','Low-Poly','Noir','Storybook Pastel'
  ];
  const artStyles = [
    'Bold Lines','Soft Pastel','Ink & Wash','Cel-Shaded','Painterly','Graphite Sketch',
    'High Contrast','Halftone Dots','Grainy Film','Vibrant Pop','Muted Vintage'
  ];
  const setAnimType = $('#setAnimType'), setArtStyle = $('#setArtStyle');
  animTypes.forEach(v=> setAnimType.append(new Option(v,v)));
  artStyles.forEach(v=> setArtStyle.append(new Option(v,v)));

  // ---------- Characters (20 slots default) ----------
  const defaultCharacters = [
    {name:'Narrator', age:'—'},
    {name:'Sidetracked Sally', age:'10'},
    {name:'Skater Skip', age:'15'},
    {name:'Dark Dan', age:'16'},
    {name:'Creative Callie', age:'14'},
    {name:'Darling Danielle', age:'17'},
    {name:'Grumpy Gus', age:'45'},
    {name:'Zen Zena', age:'18'},
    {name:'Journey Mark', age:'12'},
    {name:'Abby', age:'11'},
    {name:'Bear', age:'—'},
    {name:'Dominator A', age:'—'},
    {name:'Dominator B', age:'—'},
    {name:'Dominator C', age:'—'},
    {name:'Hero One', age:'—'},
    {name:'Hero Two', age:'—'},
    {name:'Villain One', age:'—'},
    {name:'Villain Two', age:'—'},
    {name:'Mentor', age:'—'},
    {name:'Guide', age:'—'}
  ];
  app.characters = JSON.parse(localStorage.getItem('bookanim.characters')||'null') || defaultCharacters;

  function persist(){
    localStorage.setItem('bookanim.characters', JSON.stringify(app.characters));
    localStorage.setItem('bookanim.settings', JSON.stringify({
      anim: $('#setAnimType').value, art: $('#setArtStyle').value,
      audience: $('#setAudience').value, aspect: $('#setAspect').value, fps: $('#setFps').value
    }));
    // keys (only if panel is present)
    if($('#keyOpenAI')){
      localStorage.setItem('bookanim.key.openai', $('#keyOpenAI').value || '');
      localStorage.setItem('bookanim.key.sfx',    $('#keySfx').value || '');
      localStorage.setItem('bookanim.key.other',  $('#keyOther').value || '');
    }
  }

  // Build character list (with edit)
  const charList = $('#charList');
  function renderChars(){
    charList.innerHTML = '';
    app.characters.forEach((c,i)=>{
      const row = document.createElement('div');
      row.className='listRow';
      row.innerHTML = `
        <div>
          <div style="font-weight:700">${c.name}</div>
          <div class="chipsRow" style="margin-top:.3rem;">
            ${c.age?`<span class="chip">Age: ${c.age}</span>`:''}
            ${c.voice?`<span class="chip">Voice: ${c.voice}</span>`:''}
          </div>
        </div>
        <div>
          <button class="btn ghost" data-edit="${i}">Edit</button>
        </div>`;
      charList.append(row);
    });
    // edit handlers
    charList.querySelectorAll('[data-edit]').forEach(b=>{
      b.onclick=()=>{
        const idx = +b.dataset.edit; const c = app.characters[idx];
        // quick inline editor modal (reuse characters panel body)
        const editor = document.createElement('div');
        editor.innerHTML = `
          <div class="row"><label>Name</label><input id="ceName" type="text" value="${c.name||''}"/></div>
          <div class="row"><label>Age</label><input id="ceAge" type="text" value="${c.age||''}"/></div>
          <div class="row"><label>Traits / Notes</label><textarea class="modalText" id="ceNotes" rows="5">${c.notes||''}</textarea></div>
          <div class="row"><label>Thumbnail</label><input id="ceImg" type="file" accept="image/*"/></div>
          <div class="row"><label>Voice</label><input id="ceVoice" type="text" placeholder="OpenAI voice id (e.g., ember)" value="${c.voice||''}"/></div>
          <div class="row" style="justify-content:flex-end"><button id="ceSave" class="btn">Save</button></div>
        `;
        panels.characters.querySelector('h2').innerText = `Edit: ${c.name}`;
        const original = charList.parentNode.replaceChild(editor, charList);
        $('#ceSave').onclick=()=>{
          c.name  = $('#ceName').value.trim()||c.name;
          c.age   = $('#ceAge').value.trim();
          c.notes = $('#ceNotes').value.trim();
          c.voice = $('#ceVoice').value.trim();
          const f = $('#ceImg').files?.[0];
          if(f){ const r=new FileReader(); r.onload=()=>{ c.image=r.result; done(); }; r.readAsDataURL(f); } else { done(); }
          function done(){
            app.characters[idx]=c; persist();
            panels.characters.querySelector('h2').innerText = 'Characters';
            editor.parentNode.replaceChild(original, editor);
            renderChars();
          }
        };
      };
    });
  }
  renderChars();

  $('#addChar').onclick = ()=>{
    app.characters.push({name:'New Character', age:'', notes:''});
    renderChars(); persist();
  };

  // ---------- Voices mapping ----------
  const openaiVoices = ['alloy','verse','vibrant','amber','sage','ember','nova','shimmer'];
  function renderVoices(){
    const wrap = $('#voiceMap'); wrap.innerHTML='';
    app.characters.forEach((c,i)=>{
      const row = document.createElement('div'); row.className='row';
      const sel = document.createElement('select');
      openaiVoices.forEach(v=> sel.append(new Option(v.toUpperCase(), v)));
      sel.value = c.voice || openaiVoices[0];
      sel.onchange = ()=>{ app.characters[i].voice = sel.value; persist(); };
      const label = document.createElement('label'); label.textContent = c.name;
      row.append(label, sel); wrap.append(row);
    });
  }
  renderVoices();
  $('#saveVoices').onclick = ()=>{ persist(); closePanels(); };

  // ---------- Load settings/keys on boot ----------
  (function bootstrap(){
    try{
      const st = JSON.parse(localStorage.getItem('bookanim.settings')||'{}');
      if(st.anim) $('#setAnimType').value = st.anim; else $('#setAnimType').value = 'Comic';
      if(st.art)  $('#setArtStyle').value = st.art;  else $('#setArtStyle').value = 'Bold Lines';
      $('#setAudience').value = st.audience || 'All ages';
      $('#setAspect').value   = st.aspect   || '16:9';
      $('#setFps').value      = st.fps      || '24';
      // keys
      if($('#keyOpenAI')){
        $('#keyOpenAI').value = localStorage.getItem('bookanim.key.openai') || '';
        $('#keySfx').value    = localStorage.getItem('bookanim.key.sfx')    || '';
        $('#keyOther').value  = localStorage.getItem('bookanim.key.other')  || '';
      }
    }catch(e){}
  })();

  $('#saveSettings').onclick = ()=>{ persist(); closePanels(); };
  $('#saveSecrets').onclick  = ()=>{ persist(); closePanels(); };

  // ---------- File open/upload ----------
  $('#filePicker').addEventListener('change', (e)=>{
    const files = [...e.target.files];
    if(!files.length) return;
    alert(`${files.length} file(s) selected.`);
    // (Optional) You can parse .txt into the editor here:
    const txt = files.find(f=>/\.txt$/i.test(f.name));
    if(txt){
      const r = new FileReader();
      r.onload = ()=>{ $('#bookText').value = r.result; };
      r.readAsText(txt);
    }
  });

  // ---------- Start / Preview (mock scene split + thumbnails) ----------
  const thumbs = $('#thumbs'), bar = $('#bar'), pct = $('#pct'), sceneCount = $('#sceneCount');
  function splitScenes(text){
    // simple split by blank line or sentence count
    const raw = text.split(/\n\s*\n/g).map(s=>s.trim()).filter(Boolean);
    if(raw.length) return raw;
    return text.match(/[^.!?]+[.!?]/g) || [];
  }

  function makeThumb(i, label){
    const card = document.createElement('div');
    card.innerHTML = `<div style="border:1px solid var(--border);border-radius:10px;overflow:hidden">
      <div style="aspect-ratio:16/9;background:#0f0f0f;display:grid;place-items:center;color:#aaa;">Scene ${i+1}</div>
      <div style="padding:.45rem .55rem;color:#ccc;font-size:.9rem;border-top:1px solid var(--border);">${label}</div>
    </div>`;
    thumbs.append(card);
  }

  function setProgress(v){
    bar.style.width = `${v}%`;
    pct.textContent = `${v|0}%`;
  }

  $('#btnStart').onclick = async ()=>{
    const text = $('#bookText').value.trim();
    if(!text){ alert('Please paste some text first.'); return; }
    thumbs.innerHTML = '';
    const scenes = splitScenes(text);
    sceneCount.textContent = scenes.length;
    // Fake async processing: create a thumbnail per scene
    for(let i=0;i<scenes.length;i++){
      makeThumb(i, scenes[i].slice(0,80));
      setProgress(((i+1)/scenes.length)*100);
      await new Promise(r=>setTimeout(r, 350)); // simulate work
    }
  };
  $('#btnPreview').onclick = ()=>{ window.scrollTo({top:document.body.scrollHeight, behavior:'smooth'}); };

  // ---------- Save / Export ----------
  $('#btnSave').onclick = ()=>{
    persist();
    alert('Saved locally.');
  };

  $('#btnExportZip').onclick = async ()=>{
    persist();
    const zip = new JSZip();
    // project state
    const state = {
      characters: app.characters,
      settings: JSON.parse(localStorage.getItem('bookanim.settings')||'{}'),
      text: $('#bookText').value
    };
    zip.file('project.json', JSON.stringify(state, null, 2));
    // include any embedded character images
    app.characters.forEach((c, idx)=>{
      if(c.image && c.image.startsWith('data:image')){
        const base64 = c.image.split(',')[1];
        zip.file(`images/char_${idx+1}.png`, base64, {base64:true});
      }
    });
    const blob = await zip.generateAsync({type:'blob'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'BookAnimator_Project.zip';
    a.click();
    URL.revokeObjectURL(a.href);
  };

  // ---------- Openers from menus ----------
  document.getElementById('leftMenu').addEventListener('click', (e)=>{
    const open = e.target.getAttribute('data-open');
    if(open) openPanel(open);
  });
</script>
</body>
</html>